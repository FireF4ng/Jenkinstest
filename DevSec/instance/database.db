PRAGMA foreign_keys = ON;

CREATE TABLE classes (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    nom TEXT NOT NULL
);

CREATE TABLE eleves (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT NOT NULL UNIQUE,
    nom TEXT NOT NULL,
    prenom TEXT NOT NULL,
    classe_id INTEGER NOT NULL,
    mdp TEXT NOT NULL,
    FOREIGN KEY (classe_id) REFERENCES classes (id) ON DELETE RESTRICT ON UPDATE RESTRICT
);

CREATE TABLE matieres (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    matiere TEXT NOT NULL UNIQUE
);

CREATE TABLE notes (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    note INTEGER NOT NULL,
    date DATE NOT NULL,
    matiere_id INTEGER NOT NULL,
    eleve_id INTEGER NOT NULL,
    FOREIGN KEY (matiere_id) REFERENCES matieres (id) ON DELETE RESTRICT ON UPDATE RESTRICT,
    FOREIGN KEY (eleve_id) REFERENCES eleves (id) ON DELETE RESTRICT ON UPDATE RESTRICT
);

CREATE TABLE professeurs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT NOT NULL UNIQUE,
    nom TEXT NOT NULL,
    prenom TEXT NOT NULL,
    mdp TEXT NOT NULL
);

CREATE TABLE profs_matieres (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    professeur_id INTEGER NOT NULL,
    matiere_id INTEGER NOT NULL,
    FOREIGN KEY (professeur_id) REFERENCES professeurs (id) ON DELETE RESTRICT ON UPDATE RESTRICT,
    FOREIGN KEY (matiere_id) REFERENCES matieres (id) ON DELETE RESTRICT ON UPDATE RESTRICT
);
